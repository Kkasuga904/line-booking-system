<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äºˆç´„ç®¡ç†ç”»é¢ | LINEäºˆç´„ã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 20px 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 14px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .stat-value {
            color: #333;
            font-size: 32px;
            font-weight: bold;
        }
        
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        select, button {
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-weight: 500;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .refresh-btn {
            background: #06c;
        }
        
        .table-wrapper {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-confirmed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-cancelled {
            background: #f8d7da;
            color: #721c24;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #999;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-group {
                flex-direction: column;
            }
            
            select, button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—“ï¸ äºˆç´„ç®¡ç†ç”»é¢</h1>
            <div class="subtitle">
                <span id="storeName">ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³</span> | 
                æœ€çµ‚æ›´æ–°: <span id="lastUpdate">-</span>
            </div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">æœ¬æ—¥ã®äºˆç´„</div>
                <div class="stat-value" id="todayCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">æ˜æ—¥ã®äºˆç´„</div>
                <div class="stat-value" id="tomorrowCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ä»Šé€±ã®äºˆç´„</div>
                <div class="stat-value" id="weekCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">å…¨äºˆç´„æ•°</div>
                <div class="stat-value" id="totalCount">0</div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="controls">
                <div class="filter-group">
                    <select id="dateFilter">
                        <option value="all">å…¨æœŸé–“</option>
                        <option value="today">ä»Šæ—¥</option>
                        <option value="tomorrow">æ˜æ—¥</option>
                        <option value="week">ä»Šé€±</option>
                        <option value="month">ä»Šæœˆ</option>
                    </select>
                    <select id="statusFilter">
                        <option value="all">å…¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
                        <option value="pending">äºˆç´„ç¢ºå®š</option>
                        <option value="confirmed">ç¢ºèªæ¸ˆã¿</option>
                        <option value="cancelled">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</option>
                    </select>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button style="background: #667eea;" onclick="window.location.href='/admin-calendar'">
                        ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º
                    </button>
                    <button class="refresh-btn" onclick="loadReservations()">
                        ğŸ”„ æ›´æ–°
                    </button>
                </div>
            </div>
            
            <div class="table-wrapper">
                <div id="loading" class="loading" style="display:none;">
                    èª­ã¿è¾¼ã¿ä¸­...
                </div>
                <div id="error" class="error" style="display:none;"></div>
                <table id="reservationsTable" style="display:none;">
                    <thead>
                        <tr>
                            <th>äºˆç´„ID</th>
                            <th>ãŠåå‰</th>
                            <th>æ—¥ä»˜</th>
                            <th>æ™‚é–“</th>
                            <th>äººæ•°</th>
                            <th>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</th>
                            <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                            <th>ä½œæˆæ—¥æ™‚</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="reservationsBody">
                    </tbody>
                </table>
                <div id="noData" class="no-data" style="display:none;">
                    äºˆç´„ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼šå…¨äºˆç´„ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
        let allReservations = [];
        
        // XSSå¯¾ç­–: HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—é–¢æ•°
        function escapeHtml(unsafe) {
            if (unsafe === null || unsafe === undefined) return '-';
            return String(unsafe)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#x27;')
                .replace(/\//g, '&#x2F;');
        }
        
        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°ï¼ˆYYYY-MM-DD â†’ æ—¥æœ¬èªè¡¨ç¤ºï¼‰
        // @param {string} dateStr - ISOå½¢å¼ã®æ—¥ä»˜æ–‡å­—åˆ—
        // @returns {string} ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚ºã•ã‚ŒãŸæ—¥ä»˜æ–‡å­—åˆ—
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('ja-JP');  // ä¾‹: 2024/01/20
        }
        
        // æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— â†’ æ—¥æœ¬èªè¡¨ç¤ºï¼‰
        // @param {string} dateStr - ISOå½¢å¼ã®æ—¥æ™‚æ–‡å­—åˆ—
        // @returns {string} ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚ºã•ã‚ŒãŸæ—¥æ™‚æ–‡å­—åˆ—
        function formatDateTime(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleString('ja-JP');  // ä¾‹: 2024/01/20 15:30:00
        }
        
        // æ™‚åˆ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°ï¼ˆHH:MM:SS â†’ HH:MMï¼‰
        // @param {string} timeStr - æ™‚åˆ»æ–‡å­—åˆ—ï¼ˆHH:MM:SSå½¢å¼ï¼‰
        // @returns {string} æ™‚åˆ†ã®ã¿ã®æ™‚åˆ»æ–‡å­—åˆ—
        function formatTime(timeStr) {
            if (!timeStr) return '-';
            return timeStr.substring(0, 5);  // ç§’ã‚’å‰Šé™¤
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸HTMLç”Ÿæˆé–¢æ•°
        // @param {string} status - äºˆç´„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆpending/confirmed/cancelledï¼‰
        // @returns {string} ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒãƒƒã‚¸ã®HTML
        function getStatusBadge(status) {
            const statusMap = {
                'pending': '<span class="status-badge status-pending">äºˆç´„ç¢ºå®š</span>',
                'confirmed': '<span class="status-badge status-confirmed">ç¢ºèªæ¸ˆã¿</span>',
                'cancelled': '<span class="status-badge status-cancelled">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</span>'
            };
            return statusMap[status] || status;  // æœªå®šç¾©ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¯ãã®ã¾ã¾è¡¨ç¤º
        }
        
        // çµ±è¨ˆæƒ…å ±ã‚«ãƒ¼ãƒ‰ã®æ›´æ–°
        // @param {Array} reservations - äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®é…åˆ—
        function updateStats(reservations) {
            // æ—¥ä»˜ç¯„å›²ã®è¨ˆç®—
            const today = new Date().toISOString().split('T')[0];  // ä»Šæ—¥
            const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];  // æ˜æ—¥ï¼ˆ+1æ—¥ï¼‰
            const weekEnd = new Date(Date.now() + 7 * 86400000).toISOString().split('T')[0];  // 1é€±é–“å¾Œ
            
            // å„æœŸé–“ã®äºˆç´„æ•°ã‚«ã‚¦ãƒ³ãƒˆ
            const todayCount = reservations.filter(r => r.date === today).length;
            const tomorrowCount = reservations.filter(r => r.date === tomorrow).length;
            const weekCount = reservations.filter(r => r.date >= today && r.date <= weekEnd).length;
            
            // DOMæ›´æ–°
            document.getElementById('todayCount').textContent = todayCount;
            document.getElementById('tomorrowCount').textContent = tomorrowCount;
            document.getElementById('weekCount').textContent = weekCount;
            document.getElementById('totalCount').textContent = reservations.length;
        }
        
        // äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†
        // æ—¥ä»˜ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ä¸¡æ–¹ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯èƒ½
        function filterReservations() {
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶å–å¾—
            const dateFilter = document.getElementById('dateFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            
            // å…¨ãƒ‡ãƒ¼ã‚¿ã®ã‚³ãƒ”ãƒ¼ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆ
            let filtered = [...allReservations];
            
            // æ—¥ä»˜ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];
            const weekEnd = new Date(Date.now() + 7 * 86400000).toISOString().split('T')[0];
            const monthEnd = new Date(Date.now() + 30 * 86400000).toISOString().split('T')[0];
            
            // é¸æŠã•ã‚ŒãŸæœŸé–“ã«å¿œã˜ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            switch(dateFilter) {
                case 'today':
                    filtered = filtered.filter(r => r.date === today);
                    break;
                case 'tomorrow':
                    filtered = filtered.filter(r => r.date === tomorrow);
                    break;
                case 'week':  // ä»Šé€±ï¼ˆä»Šæ—¥ã‹ã‚‰7æ—¥é–“ï¼‰
                    filtered = filtered.filter(r => r.date >= today && r.date <= weekEnd);
                    break;
                case 'month':  // ä»Šæœˆï¼ˆä»Šæ—¥ã‹ã‚‰30æ—¥é–“ï¼‰
                    filtered = filtered.filter(r => r.date >= today && r.date <= monthEnd);
                    break;
                // 'all'ã®å ´åˆã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã—
            }
            
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
            if (statusFilter !== 'all') {
                filtered = filtered.filter(r => r.status === statusFilter);
            }
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°çµæœã‚’è¡¨ç¤º
            displayReservations(filtered);
        }
        
        // äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
        // @param {Array} reservations - è¡¨ç¤ºã™ã‚‹äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®é…åˆ—
        function displayReservations(reservations) {
            // DOMè¦ç´ å–å¾—
            const tbody = document.getElementById('reservationsBody');
            const table = document.getElementById('reservationsTable');
            const noData = document.getElementById('noData');
            
            // æ—¢å­˜ã®è¡Œã‚’ã‚¯ãƒªã‚¢
            tbody.innerHTML = '';
            
            // ãƒ‡ãƒ¼ã‚¿ãªã—ã®å ´åˆã®å‡¦ç†
            if (reservations.length === 0) {
                table.style.display = 'none';
                noData.style.display = 'block';
                return;
            }
            
            // ãƒ‡ãƒ¼ã‚¿ã‚ã‚Šã®å ´åˆã¯ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
            table.style.display = 'table';
            noData.style.display = 'none';
            
            // å„äºˆç´„ãƒ‡ãƒ¼ã‚¿ã‚’è¡Œã¨ã—ã¦è¿½åŠ 
            reservations.forEach(reservation => {
                const row = tbody.insertRow();
                
                // XSSå¯¾ç­–: å„ã‚»ãƒ«ã‚’å®‰å…¨ã«ä½œæˆ
                const cells = [
                    escapeHtml(reservation.id),
                    escapeHtml(reservation.customer_name || 'ã‚²ã‚¹ãƒˆ') + 'æ§˜',
                    formatDate(reservation.date),
                    formatTime(reservation.time),
                    escapeHtml(reservation.people) + 'å',
                    escapeHtml(reservation.message || '-'),
                    getStatusBadge(reservation.status), // HTMLãƒãƒƒã‚¸ï¼ˆä¿¡é ¼ã§ãã‚‹ï¼‰
                    formatDateTime(reservation.created_at)
                ];
                
                cells.forEach((content, index) => {
                    const cell = row.insertCell(index);
                    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ã®ã¿HTMLè¨±å¯
                    if (index === 6) {
                        cell.innerHTML = content;
                    } else {
                        cell.textContent = content;
                    }
                });
                
                // æ“ä½œåˆ—ã‚’è¿½åŠ ï¼ˆå‰Šé™¤ãƒœã‚¿ãƒ³ï¼‰
                const actionCell = row.insertCell(8);
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'ğŸ—‘ï¸ å‰Šé™¤';
                deleteBtn.style.cssText = 'padding: 5px 10px; background: #ef5350; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;';
                deleteBtn.onclick = () => deleteReservation(reservation);
                actionCell.appendChild(deleteBtn);
            });
        }
        
        // äºˆç´„ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼ˆAPIçµŒç”±ï¼‰
        async function loadReservations() {
            // UIè¦ç´ å–å¾—
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            const table = document.getElementById('reservationsTable');
            const noData = document.getElementById('noData');
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            loading.style.display = 'block';
            error.style.display = 'none';
            table.style.display = 'none';
            noData.style.display = 'none';
            
            try {
                // ç’°å¢ƒã«å¿œã˜ãŸAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURLæ±ºå®š
                // ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º: /api/admin-supabase
                // Vercelæœ¬ç•ª: https://xxx.vercel.app/api/admin-supabase
                const apiUrl = window.location.hostname === 'localhost' 
                    ? '/api/admin-supabase'
                    : `${window.location.origin}/api/admin-supabase`;
                const response = await fetch(apiUrl);
                
                // HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒã‚§ãƒƒã‚¯
                if (!response.ok) {
                    throw new Error('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
                
                // JSONãƒ‡ãƒ¼ã‚¿å–å¾—
                const data = await response.json();
                allReservations = data.reservations || [];  // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ä¿å­˜
                
                // æ—¥ä»˜ãƒ»æ™‚åˆ»ã§é™é †ã‚½ãƒ¼ãƒˆï¼ˆæ–°ã—ã„äºˆç´„ãŒä¸Šï¼‰
                allReservations.sort((a, b) => {
                    const dateA = new Date(a.date + ' ' + a.time);
                    const dateB = new Date(b.date + ' ' + b.time);
                    return dateB - dateA;  // é™é †ï¼ˆæ–°ã—ã„é †ï¼‰
                });
                
                // çµ±è¨ˆæ›´æ–°ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ãƒ»è¡¨ç¤º
                updateStats(allReservations);
                filterReservations();
                
                // æœ€çµ‚æ›´æ–°æ™‚åˆ»ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã«è¡¨ç¤º
                document.getElementById('lastUpdate').textContent = 
                    new Date().toLocaleTimeString('ja-JP');  // ä¾‹: 15:30:45
                    
            } catch (err) {
                // ã‚¨ãƒ©ãƒ¼å‡¦ç†
                console.error('Error:', err);
                error.textContent = `ã‚¨ãƒ©ãƒ¼: ${err.message}`;
                error.style.display = 'block';
                noData.style.display = 'none';
            } finally {
                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤ºï¼ˆæˆåŠŸãƒ»å¤±æ•—ã©ã¡ã‚‰ã§ã‚‚å®Ÿè¡Œï¼‰
                loading.style.display = 'none';
            }
        }
        
        // äºˆç´„å‰Šé™¤æ©Ÿèƒ½
        async function deleteReservation(reservation) {
            // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
            const confirmMessage = `äºˆç´„ID: #${reservation.id}\n${reservation.customer_name || 'ã‚²ã‚¹ãƒˆ'}æ§˜\n${reservation.date} ${reservation.time.substring(0, 5)}\n\nã“ã®äºˆç´„ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
            
            if (!confirm(confirmMessage)) {
                return;
            }
            
            try {
                // å‰Šé™¤APIã‚’å‘¼ã³å‡ºã—
                const response = await fetch(`/api/admin-delete?id=${reservation.id}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    alert('äºˆç´„ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
                    // ãƒ‡ãƒ¼ã‚¿å†èª­ã¿è¾¼ã¿
                    loadReservations();
                } else {
                    alert(`å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ${result.error || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`);
                }
            } catch (error) {
                console.error('Delete error:', error);
                alert('å‰Šé™¤å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
            }
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²
        document.getElementById('dateFilter').addEventListener('change', filterReservations);  // æ—¥ä»˜ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¤‰æ›´æ™‚
        document.getElementById('statusFilter').addEventListener('change', filterReservations);  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¤‰æ›´æ™‚
        
        // è‡ªå‹•æ›´æ–°è¨­å®šï¼ˆ30ç§’ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿å†å–å¾—ï¼‰
        setInterval(loadReservations, 30000);  // 30000ms = 30ç§’
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆå›ãƒ‡ãƒ¼ã‚¿å–å¾—
        loadReservations();
    </script>
</body>
</html>